<h1 id=eleventy-plugin-local-images>eleventy-plugin-local-images <a href=#eleventy-plugin-local-images class=direct-link>#</a></h1><h2 id=what-is-this-plugin-for%3F>What is this plugin for? <a href=#what-is-this-plugin-for%3F class=direct-link>#</a></h2><p>If you are pulling your Eleventy content from a cloud-based CMS or third-party API, then chances are high that any images referenced in the content will also be hosted in cloud storage. However, <a href=https://twitter.com/@csswizardry>Harry Roberts</a> has suggested that it is usually more performant to self-host your static assets rather than host them on a CDN (<a href=https://csswizardry.com/2019/05/self-host-your-static-assets/ >source</a>).<p>This plugin is a post-processor that looks for image paths within your generated site, pulls down a uniquely-hashed local copy of each remote image and updates the filepaths in markup - That way you can be confident that your site's images will still be working, even if your CMS or cloud storage goes down.<h2 id=install-the-plugin>Install the plugin <a href=#install-the-plugin class=direct-link>#</a></h2><p>From your project directory run:<pre><code>npm install eleventy-plugin-local-images --save-dev
</code></pre><p>Once the package has installed, open up your <code>.eleventy.js</code> file.<p><strong>Step 1:</strong> Require the plugin<pre class=language-js><code class=language-js><span class="token keyword">const</span> localImages <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'eleventy-plugin-local-images'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>Step 2:</strong> Configure and add the plugin:<pre class=language-js><code class=language-js>module<span class="token punctuation">.</span><span class="token function function-variable">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">eleventyConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  eleventyConfig<span class="token punctuation">.</span><span class="token function">addPlugin</span><span class="token punctuation">(</span>localImages<span class="token punctuation">,</span> <span class="token punctuation">{</span><br>    <span class="token literal-property property">distPath</span><span class="token operator">:</span> <span class="token string">'_site'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">assetPath</span><span class="token operator">:</span> <span class="token string">'/assets/img'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">selector</span><span class="token operator">:</span> <span class="token string">'img'</span><span class="token punctuation">,</span><br>    <span class="token literal-property property">verbose</span><span class="token operator">:</span> <span class="token boolean">false</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h2 id=configuration-options>Configuration options <a href=#configuration-options class=direct-link>#</a></h2><table><thead><tr><th>Key<th>Type<th>Description<tbody><tr><td><code>distPath</code><td>String<td>The output folder for your eleventy site, e.g. <code>'_site'</code><br><strong>Required</strong><tr><td><code>assetPath</code><td>String<td>The root-relative folder where your image assets are stored, e.g. <code>'/assets/img'</code><br><strong>Required</strong><tr><td><code>selector</code><td>String<td>The css selector for the images you wish to replace. This defaults to all images <code>'img'</code>, but could be used to fence certain images only, e.g. <code>'.post-content img'</code><br>Default: <code>'img'</code><tr><td><code>attribute</code><td>String<td>The attribute containing the image path. This defaults to <code>'src'</code>, but could be used to match other attributes, e.g. <code>'srcset'</code> if targeting a <code>&lt;picture>&lt;source></code>, or <code>'data-src'</code> if using a lazy-loading plugin<br>Default: <code>'src'</code><tr><td><code>verbose</code><td>Boolean<td>Toggles console logging when images are saved locally<br>Default: <code>false</code></table><h2 id=known-issues>Known issues <a href=#known-issues class=direct-link>#</a></h2><p>Currently, as all of the image checks are carried out asynchronously, if multiple <code>&lt;img></code> tags exist with the same <code>src</code> attribute, the plugin will attempt to download the file for each instance of the path.<p>This isn't as efficient as it should be, however the plugin will always save the file with the same hashed filename, so it will at least not result in duplicated files on your local storage.<h2 id=contributing>Contributing <a href=#contributing class=direct-link>#</a></h2><p>I'm really happy to consider any contributions to this plugin. Before you make any changes, please read the <a href=https://github.com/robb0wen/eleventy-plugin-local-images/blob/master/CONTRIBUTING.md>contribution guide</a>.